组合数学相关
------------

### 相关定理

#### 定理1

$\{1, 2, … n\}$的r组合$a_1, a_2,...,a_r$出现在所有r组合中的字典序位置编号：
$$index = C(n, r) - C(n - a_1, r) - C(n - a_2, r - 1) - … - C(n - a_r, 1)$$

#### 定理2

$$k * C(n, k) = n * C(n - 1, k - 1)$$
$$C(n, 0) + C(n, 2) + … = C(n, 1) + C(n, 3) + …$$
$$1 * C(n, 1) + 2 * C(n, 2) + … + n * C(n, n) = n * 2^{n - 1}$$

### 错位排列

$$D_n=n!\sum_{k=0}^{n}\frac{(-1)^k}{k!}$$

### Catalan数

凸多边形三角划分,n个节点组成二叉搜索树，n对括号正确匹配数目，1-n的出栈序列
$$C_n = \frac{C(2 * n, n)}{n + 1}$$
$$C_n = \frac{(4 * n - 2)}{n + 1} * C_n - 1$$ $$C_1 = 1$$

### Stirling数

#### 第一类Stirling数

s(p, k)将 p 个不同元素构成 k 个圆排列的数目。
$$s(p, k) = (p - 1) * s(p - 1, k) + s(p - 1, k - 1)$$

#### 第二类Stirling数

n个元素拆分k个集合的方案数记为S(n, k)。
$$S(p, k) = k * S(p - 1, k) + S(p - 1, k - 1)$$
$$S(p, 0) = 0, (p >= 1)$$ $$S(p, p) = 1, (p >= 0)$$
$$S(p, 1) = 1, (p >= 1)$$ $$S(p, 2) = 2^{p - 1} - 1, (p >= 2)$$
$$S(p, p - 1) = C(p, 2)$$

### Bell数

元素个数为n的集合的划分数目。 $$B_p = \sum_{i=0}^{p}S(p, i)$$
其中$S(p,i)$表示第二类Stirling数。
$$B_p = C(p - 1, 0) * B_0 + C(p - 1, 1) * B_1 + … + C(p - 1, p - 1) * B_{p - 1}$$

### 卢卡斯定理

若$p$是质数： $$C(n,m)\%p=C(n/p,m/p)*C(n\%p,m\%p)\%p$$
若$p$不是质数，令$p=p_1*p_2*...*p_n$，这里$p_i$是质数 $$\left\{
\begin{aligned}
C_n^m \equiv & a_1 \pmod {p_1} \\
C_n^m \equiv & a_2 \pmod {p_2} \\
\vdots \\
C_n^m \equiv & a_n \pmod {p_n}
\end{aligned}
\right.$$ 则分别求出$a_1,a_2,...,a_n$用中国剩余定理合并即可。

